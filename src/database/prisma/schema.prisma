// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  name      String?
  password  String
  address   String?
  nip       String?  @unique
  gender    String?
  phone     String?
  status    Int      @default(0)
  role      String   @default("user")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  los Los[]
}

model Patient {
  id         String   @id @default(uuid())
  name       String
  nik        String
  gender     String
  birthPlace String
  birthDate  String
  address    String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  los Los[]
}

model Los {
  id               String    @id @default(uuid())
  patientId        String
  staffId          String?
  bedId            String?
  age              Int?
  startDate        DateTime
  endDate          DateTime?
  estimate         Int?
  actual           Int?
  NumTransfers     Float
  NumDiagnosis     Float
  NumNotes         Float
  NumLabs          Float
  TotalNumInteract Float
  NumChartEvents   Float
  NumProcs         Float
  NumMicroLabs     Float
  NumInput         Float
  NumRx            Float
  NumOutput        Float
  NumCPTevents     Float
  NumCallouts      Float
  status           Int       @default(0)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt

  patient Patient @relation(fields: [patientId], references: [id], onDelete: Cascade)
  staff   User?   @relation(fields: [staffId], references: [id], onDelete: SetNull)
  bed     Bed?    @relation(fields: [bedId], references: [id], onDelete: SetNull)
}

model Bed {
  id        String   @id @default(uuid())
  room      String
  bed       String
  status    Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  los Los[]

  @@unique([room, bed])
}
